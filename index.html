<!DOCTYPE html>

<style>
.axis path,
.axis line {
    fill: none;
    stroke: #eee;
    shape-rendering: crispEdges;
}

.axis text {
    font-family: sans-serif;
    font-size: 11px;
}

.loading {
    font-family: sans-serif;
    font-size: 15px;
}

.circle {
    fill: #222;
}
</style>


<div id="graph"></div>

<script src="https://d3js.org/d3.v4.min.js"></script>
<script >

var newData = [];

d3.json("data.json", function(data){

var xMin = d3.min(data, function(d){return d.x}), //max and min
    xMax = d3.max(data, function(d){return d.x}),
    yMin = d3.min(data, function(d){return d.y}),
    yMax = d3.max(data, function(d){return d.y});

var w = 940,
    h = 500,
    pad = 20,
    left_pad = 100;

var svg = d3.select("#graph")
            .append("svg")
            .attr("width", w)
            .attr("height", h);


var xScale = d3.scaleLinear().domain([xMin,xMax]).range([left_pad, w-pad]),
    yScale = d3.scaleLinear().domain([yMax,yMin]).range([pad, h-pad*2]);

var xAxis = d3.axisBottom(xScale),
    yAxis = d3.axisLeft(yScale);

var cValue = function(d) { return d.person;},
    color = d3.scaleOrdinal(d3.schemeCategory10);

svg.append("g")
   .attr("class", "axis")
   .attr("transform", "translate(0, "+(h-pad)+")")
   .call(xAxis);

svg.append("g")
   .attr("class", "axis")
   .attr("transform", "translate("+(left_pad-pad)+", 0)")
   .call(yAxis);

svg.append("g")
    .attr("class", "brush")
    .call(d3.brushY().on("brush",brushed));

svg.selectAll("circle")
   .data(data)
   .enter()
   .append("circle")
   .attr("class", "circle")
   .attr("cx", function (d) { return xScale(d.x) })
   .attr("cy", function (d) { return yScale(d.y) })
   .attr("r", 1)
   .style("fill",function(d) { return color(d.person);} );

   //the function that takes care of what happens on "brush" event
   function brushed() {
     var area = d3.event.selection;
     var miny = area[0];
     var maxy = area[1];
     svg.selectAll("circle").style("fill",function(d){
       // console.log("miny: " + miny + " maxy: " + maxy);
       if(yScale(d.y) >= miny && yScale(d.y) <= maxy){
         return "red";
       }else{
         return "gray";
       }
     });
   }
});



</script>
